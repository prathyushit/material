{"ast":null,"code":"import axios from \"axios\";\nimport { getItemFromLS } from \"./storage\";\nimport { rootStore } from \"../store/rootStore\";\nimport { performLogout } from \"./authUtils\";\n\n// const BASE_URL = \"https://6i4wiooc74.execute-api.us-east-1.amazonaws.com/\";\n//const BASE_URL = \"https://amekkdkvdl.execute-api.us-east-1.amazonaws.com/\"; contractor account\nconst BASE_URL = \"https://wwbxtxwme1.execute-api.us-east-1.amazonaws.com/\";\nlet axiosInstance;\naxiosInstance = axios.create({\n  baseURL: BASE_URL\n});\naxiosInstance.interceptors.request.use(async config => {\n  try {\n    const token = getItemFromLS(\"id_token\");\n    if (token) {\n      config.headers[\"Authorization\"] = `Bearer ${token}`;\n      config.headers[\"Content-Type\"] = \"application/json\";\n    }\n  } catch (e) {\n    console.log(e);\n    console.log(`unauthenticated request to ${config.url}`);\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\naxiosInstance.interceptors.response.use(response => {\n  return response;\n}, async function (error) {\n  const originalRequest = error.config;\n  if (!error.response) {\n    return Promise.reject(new Error(\"Network error or request was not sent\"));\n  }\n  if (error.response.status === 401 && !originalRequest._retry) {\n    originalRequest._retry = true;\n    try {\n      const newToken = await rootStore.authStore.refreshToken();\n      if (newToken) {\n        return axiosInstance(originalRequest);\n      }\n    } catch (e) {\n      performLogout();\n      window.location.href = \"/sign-in\";\n    }\n  }\n  return Promise.reject(error);\n});\nexport default axiosInstance;","map":{"version":3,"names":["axios","getItemFromLS","rootStore","performLogout","BASE_URL","axiosInstance","create","baseURL","interceptors","request","use","config","token","headers","e","console","log","url","error","Promise","reject","response","originalRequest","Error","status","_retry","newToken","authStore","refreshToken","window","location","href"],"sources":["C:/Users/swamy/Downloads/material-dashboard-react-main/material-dashboard-react-main/src/config/http.js"],"sourcesContent":["import axios from \"axios\";\nimport { getItemFromLS } from \"./storage\";\nimport { rootStore } from \"../store/rootStore\";\nimport { performLogout } from \"./authUtils\";\n\n// const BASE_URL = \"https://6i4wiooc74.execute-api.us-east-1.amazonaws.com/\";\n//const BASE_URL = \"https://amekkdkvdl.execute-api.us-east-1.amazonaws.com/\"; contractor account\nconst BASE_URL = \"https://wwbxtxwme1.execute-api.us-east-1.amazonaws.com/\";\n\nlet axiosInstance;\naxiosInstance = axios.create({\n  baseURL: BASE_URL,\n});\n\naxiosInstance.interceptors.request.use(\n  async (config) => {\n    try {\n      const token = getItemFromLS(\"id_token\");\n\n      if (token) {\n        config.headers[\"Authorization\"] = `Bearer ${token}`;\n        config.headers[\"Content-Type\"] = \"application/json\";\n      }\n    } catch (e) {\n      console.log(e);\n      console.log(`unauthenticated request to ${config.url}`);\n    }\n\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\naxiosInstance.interceptors.response.use(\n  (response) => {\n    return response;\n  },\n  async function (error) {\n    const originalRequest = error.config;\n\n    if (!error.response) {\n      return Promise.reject(new Error(\"Network error or request was not sent\"));\n    }\n\n    if (error.response.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n\n      try {\n        const newToken = await rootStore.authStore.refreshToken();\n\n        if (newToken) {\n          return axiosInstance(originalRequest);\n        }\n      } catch (e) {\n        performLogout();\n        window.location.href = \"/sign-in\";\n      }\n    }\n    return Promise.reject(error);\n  }\n);\n\nexport default axiosInstance;\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,aAAa,QAAQ,WAAW;AACzC,SAASC,SAAS,QAAQ,oBAAoB;AAC9C,SAASC,aAAa,QAAQ,aAAa;;AAE3C;AACA;AACA,MAAMC,QAAQ,GAAG,yDAAyD;AAE1E,IAAIC,aAAa;AACjBA,aAAa,GAAGL,KAAK,CAACM,MAAM,CAAC;EAC3BC,OAAO,EAAEH;AACX,CAAC,CAAC;AAEFC,aAAa,CAACG,YAAY,CAACC,OAAO,CAACC,GAAG,CACpC,MAAOC,MAAM,IAAK;EAChB,IAAI;IACF,MAAMC,KAAK,GAAGX,aAAa,CAAC,UAAU,CAAC;IAEvC,IAAIW,KAAK,EAAE;MACTD,MAAM,CAACE,OAAO,CAAC,eAAe,CAAC,GAAG,UAAUD,KAAK,EAAE;MACnDD,MAAM,CAACE,OAAO,CAAC,cAAc,CAAC,GAAG,kBAAkB;IACrD;EACF,CAAC,CAAC,OAAOC,CAAC,EAAE;IACVC,OAAO,CAACC,GAAG,CAACF,CAAC,CAAC;IACdC,OAAO,CAACC,GAAG,CAAC,8BAA8BL,MAAM,CAACM,GAAG,EAAE,CAAC;EACzD;EAEA,OAAON,MAAM;AACf,CAAC,EACAO,KAAK,IAAK;EACT,OAAOC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CACF,CAAC;AAEDb,aAAa,CAACG,YAAY,CAACa,QAAQ,CAACX,GAAG,CACpCW,QAAQ,IAAK;EACZ,OAAOA,QAAQ;AACjB,CAAC,EACD,gBAAgBH,KAAK,EAAE;EACrB,MAAMI,eAAe,GAAGJ,KAAK,CAACP,MAAM;EAEpC,IAAI,CAACO,KAAK,CAACG,QAAQ,EAAE;IACnB,OAAOF,OAAO,CAACC,MAAM,CAAC,IAAIG,KAAK,CAAC,uCAAuC,CAAC,CAAC;EAC3E;EAEA,IAAIL,KAAK,CAACG,QAAQ,CAACG,MAAM,KAAK,GAAG,IAAI,CAACF,eAAe,CAACG,MAAM,EAAE;IAC5DH,eAAe,CAACG,MAAM,GAAG,IAAI;IAE7B,IAAI;MACF,MAAMC,QAAQ,GAAG,MAAMxB,SAAS,CAACyB,SAAS,CAACC,YAAY,CAAC,CAAC;MAEzD,IAAIF,QAAQ,EAAE;QACZ,OAAOrB,aAAa,CAACiB,eAAe,CAAC;MACvC;IACF,CAAC,CAAC,OAAOR,CAAC,EAAE;MACVX,aAAa,CAAC,CAAC;MACf0B,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,UAAU;IACnC;EACF;EACA,OAAOZ,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CACF,CAAC;AAED,eAAeb,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}